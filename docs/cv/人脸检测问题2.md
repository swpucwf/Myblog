### 人脸检测

- FDDB : 早期无约束场景
- WiderFace : 最重要, 常用的评测基准，32203图，393703人脸
- MAFA：遮挡人脸数据集，30811张图，35806遮挡
- UFDD : 非限制场景，雨天，雪天，雾天，模糊，光照，晶体障碍，
  干扰物，6425张图，10897张脸
- DFW : 伪造脸



#### WiderFace

- WiderFace
- 图像的宽都缩放到1024像素，图像较大
- 最小标注的人脸大小为 $10 \times 10$ ，平均一张图超过 10 个人脸，密集小人脸非常多
- 训练集，验证集，测试集分别占 $40 \% ， 10 \% ， 50 \%$ ，测试集非常大，结果可靠性高。
- 根据EdgeBox方法的检测率Wider-face评测被划分为三个难度等级：Easy, Medium, Hard。
- ![image-20220306235447238](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220306235447238.png)

### 人脸检测方法

- 人脸组件算法
- 级连检测算法
- 通用目标检测模型

#### 基于人脸先验知识的方法

- Faceness : 分区域检测人脸五官 (概率图 ) - 基于五官分布规则
  - 人脸概率图计算
  - 基于预定规则
  - 积分图快速计算
- ![image-20220306235659271](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220306235659271.png)

#### Cascade CNN

- 级联结构不断筛选候选框
- 边界改进网络更好的定位人脸位置

- 3个尺度的检测网络 ( 12net，24net，48net )
- 3个尺度的边界修订网络 ( 12-calibration-net，24-calibration-net，48calibration-net )
边界修订网络45类分类器 : (1) x方向上- $0.17 、 0 、 0.17$ 共3种平移。(2) y方向上-0.17、0、0.17共 3 种 平移。(3) $0.83 、 0.91 、 1.0 、 1.1 、 1.21$ 共5种缩放尺度。

其中MTCNN

![image-20220307000109382](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220307000109382.png)

![image-20220307000119200](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220307000119200.png)

与Cascade CNN相比 : (1) 增加了5个关键点的回归任务，多任务融合。(2) 直接回归偏移量，而不是进行模式分类。(3) 多尺度输入图+卷积，而不是穷举 的滑动窗口。

#### 通用的目标检测

![image-20220307000210034](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220307000210034.png)



### 小脸检测

- 小脸检测问题

  ##### 带来的问题

  - 尺度小，模糊
  - 感受野的大小和预设anchor的大小、小脸的大小不匹配

- 多尺度技术

  ![image-20220307000402752](../images/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B.assets/image-20220307000402752.png)

  - 图像金字塔
  - 多尺度特征
  - 多尺度预测
  - 各类方法融合

- Anchor策略

  - 尽可能地预设更多小尺度的anchor ( stride=4 )
  - stride增加一倍时， anchor的边长也增加一倍，不同尺度大小的脸将匹配上与 之相当数量的anchor

- Context信息

  - 对于小脸，随着感受野的增加，性 能先提升然后下降
    - 创建一个图像金字塔，分别上采 样两倍和下采样两倍，每次随机 选择一个尺度进行训练

- 超分

  - Up-sample sub-network: 上采样4倍
  - Refinement sub-network: 改进人脸细节

  ### 开源项目

- MTCNN
-  https://github.com/kpzhang93/MTCNN_face_detection_alignment 
- https://github.com/AITTSMD/MTCNN-Tensorflow
- RetinaFace
- https://github.com/biubug6/Pytorch_Retinaface
- https://github.com/YonghaoHe/A-Light-and-Fast-Face-Detector-for-Edge-Devices
- AWESome Face
- https://github.com/ChanChiChoi/awesome-Face Recognition

